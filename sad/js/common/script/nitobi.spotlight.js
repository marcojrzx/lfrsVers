if(typeof (nitobi)=="undefined"||typeof (nitobi.lang)=="undefined"){
alert("The Nitobi framework source could not be found. Is it included before any other Nitobi components?");
}
nitobi.lang.defineNs("nitobi.spotlight");
nitobi.spotlight.build="5881";
nitobi.spotlight.version="1.0.5881";
nitobi.lang.defineNs("nitobi.callout");
if(false){
nitobi.callout=function(){
};
}
nitobi.callout.lastStyle="";
nitobi.callout.Callout=function(_1){
nitobi.prepare();
this.uid=Math.random().toString().replace(".","").replace("0","");
nitobi.callout.Callout.refs[nitobi.callout.Callout.refs.length]=this;
this.attributesTimer=null;
this.ver="1.11";
this.titlehtml="";
this.stylesheet="xp";
this.allowOffScreen=true;
if(_1!=null){
this.stylesheet=_1.toLowerCase();
}
this.Is=function(){
this.opera=false;
_2=navigator.userAgent.toLowerCase();
this.major=parseInt(navigator.appVersion);
this.minor=parseFloat(navigator.appVersion);
this.firefox=false;
if(navigator.userAgent.indexOf("Firefox")!=-1){
this.firefox=true;
}
this.ns=((_2.indexOf("mozilla")!=-1)&&(_2.indexOf("spoofer")==-1)&&(_2.indexOf("compatible")==-1)&&(_2.indexOf("opera")==-1)&&(_2.indexOf("webtv")==-1)&&(_2.indexOf("hotjava")==-1));
this.ns2=(this.ns&&(this.major==2));
this.ns3=(this.ns&&(this.major==3));
this.ns4=(this.ns&&(this.major==4));
this.ns6=(this.ns&&(this.major>=5));
this.ie=((_2.indexOf("msie")!=-1)&&(_2.indexOf("opera")==-1));
this.ie3=(this.ie&&(this.major<4));
this.ie4=(this.ie&&(this.major==4)&&(_2.indexOf("msie 4")!=-1));
this.ie5=(this.ie&&(this.major==4)&&(_2.indexOf("msie 5.")!=-1)&&(_2.indexOf("msie 5.5")==-1)&&(_2.indexOf("mac")==-1));
this.ie6=(this.ie&&(this.major==4)&&(_2.indexOf("msie 6.")!=-1));
this.ie7=(this.ie&&(this.major==4)&&(_2.indexOf("msie 7.0")!=-1));
if(_2.indexOf("opera")==0){
this.opera=true;
}
};
var _2=navigator.userAgent.toLowerCase();
if(_2.indexOf("opera")==0){
this.opera=true;
}
if(_2.indexOf("Firefox")!=-1){
this.firefox=true;
}
if(_2.indexOf("msie")==0){
this.ie=true;
}
this.HaltAttributes=false;
this.ContainerNames=Array();
this.Containers=Array();
this.MasterContainer=document.createElement("div");
this.MasterContainer.innerHTML="";
this.MasterContainer.setAttribute("id","ntbCalloutMasterContainer"+this.uid);
this.MasterContainer.object=this;
this.MasterContainer.style.position="absolute";
this.MasterContainer.style.top="0px";
this.MasterContainer.style.left="0px";
this.timerObject=null;
this.expireObj=null;
this.object=this;
this.absWidth=0;
this.absHeight=0;
this.zSpot=(nitobi.callout.Callout.refs.length*10)+1000000;
this.ondestroy=null;
this.onappear=null;
this.onScreenUpdate=null;
this.timeOut=-1;
this.x=0;
this.y=0;
this.ax=0;
this.ay=0;
this.width=0;
this.height=0;
this.MasterContainer.style.visibility="hidden";
this.MasterContainer.style.zIndex=this.zSpot.toString();
document.getElementsByTagName("body").item(0).appendChild(this.MasterContainer);
for(var t=0;t<6;t++){
this.ContainerNames[t]="ntbCalloutContainer"+t+"_"+this.uid;
this.Containers[t]=document.createElement("div");
this.Containers[t].innerHTML="";
this.Containers[t].setAttribute("id",this.ContainerNames[t]);
this.Containers[t].object=this;
this.MasterContainer.appendChild(this.Containers[t]);
this.Containers[t].style.position="absolute";
this.Containers[t].style.top="0px";
this.Containers[t].style.left="0px";
this.Containers[t].style.zIndex=this.zSpot.toString();
}
this.TitleElement="ntbCalloutTitle_"+this.uid;
this.TitleElement=document.createElement("div");
this.TitleElement.innerHTML="";
this.TitleElement.setAttribute("id","title"+this.uid);
this.TitleElement.object=this;
this.MasterContainer.appendChild(this.TitleElement);
this.TitleElement.style.position="absolute";
this.TitleElement.style.zIndex=(this.zSpot+1).toString();
this.TitleElement.style.visibility="visible";
this.TitleElement.style.display="block";
this.CloseElement="ntbCalloutClose_"+this.uid;
this.CloseElement=document.createElement("div");
this.CloseElement.innerHTML="";
this.CloseElement.setAttribute("id","close"+this.uid);
this.CloseElement.object=this;
this.MasterContainer.appendChild(this.CloseElement);
this.CloseElement.style.position="absolute";
this.CloseElement.style.zIndex=(this.zSpot+5).toString();
this.CloseElement.style.visibility="visible";
this.CloseElement.style.display="block";
this.CloseElement.className="ntb"+this.stylesheet+"Callout_close_off";
this.CloseElement.onmouseover=function(){
try{
var _4=this.className.replace("_off","_on");
this.className=_4;
}
catch(e){
}
};
this.CloseElement.onmouseout=function(){
try{
var _5=this.className.replace("_on","_off");
this.className=_5;
}
catch(e){
}
};
this.CloseElement.onmousedown=function(){
try{
var _6=this.className.replace("_on","_off");
this.className=_6;
}
catch(e){
}
};
var _7=this;
this.CloseElement.onmouseup=function(){
try{
var _8=this.className.replace("_off","_on");
this.className=_8;
}
catch(e){
}
_7.destroy();
return false;
};
this.CloseElement.onclick=function(){
return false;
};
this.BodyElement="ntbCalloutBody_"+this.uid;
this.BodyElement=document.createElement("div");
this.BodyElement.innerHTML="";
this.BodyElement.setAttribute("id","body"+this.uid);
this.BodyElement.object=this;
this.MasterContainer.appendChild(this.BodyElement);
this.BodyElement.style.position="absolute";
this.BodyElement.style.zIndex=(this.zSpot+4).toString();
this.BodyElement.style.visibility="visible";
this.BodyElement.style.display="block";
nitobi.callout.lastStyle=this.stylesheet;
this.StyleSheetUrl=nitobi.callout.Callout.getStyleSheetUrl();
this.setMode("INACTIVE");
this.CalloutMinWidth=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_minimums","width");
this.CalloutMinHeight=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_minimums","height");
this.CalloutContentWidth=200;
this.CalloutContentHeight=0;
if(this.CalloutContentWidth<this.CalloutMinWidth){
this.CalloutContentWidth=this.CalloutMinWidth;
}
if(this.CalloutContentHeight<this.CalloutMinHeight){
this.CalloutContentHeight=this.CalloutMinHeight;
}
this.CalloutDirection=0;
this.setCalloutDirection(1);
if(nitobi.callout.Callout.refs.length==1){
if(window.addEventListener){
window.addEventListener("scroll",nitobi.callout.Callout.update,false);
window.addEventListener("resize",nitobi.callout.Callout.update,false);
}else{
if(window.attachEvent){
window.attachEvent("onscroll",nitobi.callout.Callout.update);
window.attachEvent("onresize",nitobi.callout.Callout.update);
}
}
}
this.setTitle("");
this.bodyHTML="";
this.useBody=false;
this.setBody("");
this.effectName="APPEAR";
this.opacity=1;
this.setEffect("FADE");
this.setOpacity(0);
};
nitobi.callout.Callout.styleArray=Array();
nitobi.callout.Callout.ruleArray=Array();
nitobi.callout.Callout.globalStylesheet;
nitobi.callout.Callout.precachedImages=Array();
nitobi.callout.Callout.refs=Array();
nitobi.callout.Callout.permHeight=0;
nitobi.callout.Callout.permWidth=0;
nitobi.callout.Callout.globalStyleSheetName="nitobi.attention.css";
nitobi.callout.Callout.rewriteId=function(_9){
try{
document.getElementById(_9).id=_9;
}
catch(e){
try{
for(var i=0;i<document.forms.length;i++){
for(var b=0;b<document.forms[i].elements.length;b++){
if(document.forms[i].elements[b].name.toUpperCase()==_9.toUpperCase()){
document.forms[i].elements[b].id=_9;
}
}
}
}
catch(e){
}
}
};
nitobi.callout.Callout.update=function(){
var t,o;
for(t=0;t<nitobi.callout.Callout.refs.length;t++){
o=nitobi.callout.Callout.refs[t];
clearTimeout(o.timerObject);
o.timerObject=setTimeout("nitobi.callout.Callout.refs["+t+"].updateCallout()",150);
}
};
nitobi.callout.destroyAll=function(){
var t,o;
for(t=0;t<nitobi.callout.Callout.refs.length;t++){
o=nitobi.callout.Callout.refs[t];
o.destroy();
}
};
nitobi.callout.destroyLast=function(){
var t,o;
for(t=0;t<nitobi.callout.Callout.refs.length;t++){
o=nitobi.callout.Callout.refs[t];
}
try{
o.destroy();
}
catch(e){
}
};
nitobi.callout.Callout.prototype.setOnScreenUpdate=function(_12){
this.onScreenUpdate=_12;
};
nitobi.callout.Callout.prototype.setOnDestroy=function(_13){
this.ondestroy=_13;
};
nitobi.callout.Callout.prototype.setOnAppear=function(_14){
this.onappear=_14;
};
nitobi.callout.Callout.prototype.setExpire=function(_15){
this.timeOut=_15;
var ds=this;
this.expireObj=setTimeout(function(){
ds.destroy();
},_15);
};
nitobi.callout.Callout.prototype.setSize=function(_17,_18){
this.absWidth=_17;
this.absHeight=_18;
this.setTitle(this.titlehtml);
};
nitobi.callout.Callout.prototype.getPosition=function(){
return {x:this.ax,y:this.ay};
};
nitobi.callout.Callout.prototype.setEffect=function(_19){
this.effectName="FADE";
};
nitobi.callout.Callout.prototype.setTitle=function(_1a){
this.titlehtml=_1a;
if(_1a.length>0){
this.useTitle=true;
}else{
this.useTitle=false;
}
if(this.useTitle){
try{
this.TitleElement.style.visibility="visible";
this.TitleElement.className="ntb"+this.stylesheet+"Callout_titlediv"+this.CalloutDirection;
this.TitleElement.innerHTML=this.titlehtml;
if(this.CalloutContentWidth<this.TitleElement.offsetWidth+30){
this.CalloutContentWidth=this.TitleElement.offsetWidth+30;
}
this.setBody(this.bodyHTML);
}
catch(e){
}
}else{
this.TitleElement.style.visibility="visible";
this.TitleElement.innerHTML="&nbsp;";
}
if(!this.HaltAttributes){
this.assignAttributes();
}
};
nitobi.callout.Callout.prototype.setBody=function(_1b){
try{
this.bodyHTML=_1b;
var _1c=_1b.replace(/(<([^>]+)>)/ig,"");
var _1d=_1c.length;
if(_1b.length>0){
this.useBody=true;
}else{
this.useBody=false;
}
if(this.useBody){
this.BodyElement.style.visibility="visible";
if(this.CalloutContentWidth<((_1d/12)*nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_extender","width"))){
this.CalloutContentWidth=(_1d/12)*nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_extender","width");
}
this.BodyElement.style.width=this.CalloutContentWidth+"px";
this.BodyElement.className="ntb"+this.stylesheet+"Callout_bodydiv"+this.CalloutDirection;
this.BodyElement.innerHTML=_1b;
if(this.useTitle==false){
this.BodyElement.style.top=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_bodytitlediv"+this.CalloutDirection,"top")+"px";
this.BodyElement.style.left=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_bodytitlediv"+this.CalloutDirection,"left")+"px";
this.BodyElement.style.marginTop="";
this.CalloutContentHeight=this.BodyElement.offsetHeight+nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_bodytitlediv"+this.CalloutDirection,"top");
this.CalloutContentHeight-=parseInt(this.TitleElement.offsetHeight);
}else{
this.BodyElement.style.top="";
this.BodyElement.style.left="";
var _1e=parseInt(nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_titleOffset","top"));
if(isNaN(_1e)){
_1e=0;
}
this.CalloutContentHeight=this.BodyElement.offsetHeight+parseInt(nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_bodytitlediv"+this.CalloutDirection,"top"))+_1e;
}
}else{
this.BodyElement.style.visibility="hidden";
}
if((this.absWidth>0)||(this.absHeight>0)){
this.CalloutContentWidth=this.absWidth+nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_bodytitlediv"+this.CalloutDirection,"left");
this.CalloutContentHeight=this.absHeight+nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_bodytitlediv"+this.CalloutDirection,"top");
}
if(!this.HaltAttributes){
this.assignAttributes();
}
}
catch(e){
}
};
nitobi.callout.Callout.prototype.setCalloutDirection=function(_1f){
var _20=this.titlehtml;
if(_1f!=this.CalloutDirection){
this.CalloutDirection=_1f;
this.setTitle(_20);
if(!this.HaltAttributes){
this.assignAttributes();
}
}
};
nitobi.callout.Callout.prototype.updateCallout=function(){
if(this.mode=="ATTACHELEMENT"){
this.attachToElement(this.lastID);
}
};
nitobi.callout.Callout.prototype.assignAttributes=function(_21){
var t,_23,_24,_25=0;
var _26,_27=0;
try{
for(t=0;t<6;t++){
this.Containers[t].style.display="none";
this.Containers[t].style.width="";
this.Containers[t].style.height="";
this.Containers[t].style.top="0px";
this.Containers[t].style.left="0px";
}
_26=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_offset"+this.CalloutDirection,"width");
_27=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_offset"+this.CalloutDirection,"height");
var _28=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_closeoffset"+this.CalloutDirection,"left");
var _29=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_closeoffset"+this.CalloutDirection,"top");
this.CalloutContentWidth+=_26;
this.CalloutContentHeight+=_27;
if(this.CalloutDirection==0){
for(t=0;t<4;t++){
this.Containers[t].style.display="block";
}
_23=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_bl_right","width");
_24=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_tl_br_plain","width");
this.width=_23+this.CalloutContentWidth;
this.height=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_tl_br_plain","height")+this.CalloutContentHeight;
this.MasterContainer.style.width=this.width;
this.MasterContainer.style.height=this.height;
this.Containers[0].className="ntb"+this.stylesheet+"Callout_bl_main";
this.Containers[0].style.top="0px";
this.Containers[0].style.width=this.CalloutContentWidth+"px";
this.Containers[0].style.height=this.CalloutContentHeight+"px";
this.swapIEPNG(0,"ntb"+this.stylesheet+"Callout_bl_main");
this.Containers[1].className="ntb"+this.stylesheet+"Callout_bl_right";
this.Containers[1].style.left=this.CalloutContentWidth+"px";
this.Containers[1].style.height=this.CalloutContentHeight+"px";
this.Containers[1].style.top="0px";
this.swapIEPNG(1,"ntb"+this.stylesheet+"Callout_bl_right");
this.Containers[2].className="ntb"+this.stylesheet+"Callout_bottom_plain";
this.Containers[2].style.left="0px";
this.Containers[2].style.width=(this.CalloutContentWidth+parseInt(_23)-parseInt(_24))+"px";
this.Containers[2].style.top=this.CalloutContentHeight+"px";
this.swapIEPNG(2,"ntb"+this.stylesheet+"Callout_bottom_plain");
this.Containers[3].className="ntb"+this.stylesheet+"Callout_tl_br_plain";
this.Containers[3].style.left=(this.CalloutContentWidth+parseInt(_23)-parseInt(_24))+"px";
this.Containers[3].style.top=this.CalloutContentHeight+"px";
this.swapIEPNG(3,"ntb"+this.stylesheet+"Callout_tl_br_plain");
this.CloseElement.style.left=(this.CalloutContentWidth+_28)+"px";
this.CloseElement.style.top=_29+"px";
}
if(this.CalloutDirection==1){
for(t=0;t<4;t++){
this.Containers[t].style.display="block";
}
_23=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_bl_right","width");
_24=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_br_bottom","width");
this.width=_23+this.CalloutContentWidth;
this.height=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_br_bottom","height")+this.CalloutContentHeight;
this.MasterContainer.style.width=this.width;
this.MasterContainer.style.height=this.height;
this.Containers[0].className="ntb"+this.stylesheet+"Callout_bl_main";
this.Containers[0].style.top="0px";
this.Containers[0].style.width=this.CalloutContentWidth+"px";
this.Containers[0].style.height=this.CalloutContentHeight+"px";
this.swapIEPNG(0,"ntb"+this.stylesheet+"Callout_bl_main");
this.Containers[1].className="ntb"+this.stylesheet+"Callout_bl_right";
this.Containers[1].style.left=this.CalloutContentWidth+"px";
this.Containers[1].style.height=this.CalloutContentHeight+"px";
this.Containers[1].style.top="0px";
this.swapIEPNG(1,"ntb"+this.stylesheet+"Callout_bl_right");
this.Containers[2].className="ntb"+this.stylesheet+"Callout_bottom_plain";
this.Containers[2].style.left="0px";
this.Containers[2].style.width=(this.CalloutContentWidth+parseInt(_23)-parseInt(_24))+"px";
this.Containers[2].style.top=this.CalloutContentHeight+"px";
this.swapIEPNG(2,"ntb"+this.stylesheet+"Callout_bottom_plain");
this.Containers[3].className="ntb"+this.stylesheet+"Callout_br_bottom";
this.Containers[3].style.left=(this.CalloutContentWidth+parseInt(_23)-parseInt(_24))+"px";
this.Containers[3].style.top=this.CalloutContentHeight+"px";
this.swapIEPNG(3,"ntb"+this.stylesheet+"Callout_br_bottom");
this.CloseElement.style.left=(this.CalloutContentWidth+_28)+"px";
this.CloseElement.style.top=_29+"px";
}
if(this.CalloutDirection==2){
for(t=0;t<4;t++){
this.Containers[t].style.display="block";
}
_23=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_bl_right","width");
_24=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_br_plain","width");
this.width=_23+this.CalloutContentWidth;
this.height=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_bl_bottom","height")+this.CalloutContentHeight;
this.MasterContainer.style.width=this.width;
this.MasterContainer.style.height=this.height;
this.Containers[0].className="ntb"+this.stylesheet+"Callout_bl_main";
this.Containers[0].style.width=this.CalloutContentWidth+"px";
this.Containers[0].style.height=this.CalloutContentHeight+"px";
this.swapIEPNG(0,"ntb"+this.stylesheet+"Callout_bl_main");
this.Containers[1].className="ntb"+this.stylesheet+"Callout_bl_right";
this.Containers[1].style.left=this.CalloutContentWidth+"px";
this.Containers[1].style.height=this.CalloutContentHeight+"px";
this.Containers[1].style.top="0px";
this.swapIEPNG(1,"ntb"+this.stylesheet+"Callout_bl_right");
this.Containers[2].className="ntb"+this.stylesheet+"Callout_bl_bottom";
this.Containers[2].style.left="0px";
this.Containers[2].style.width=(this.CalloutContentWidth+parseInt(_23)-parseInt(_24))+"px";
this.Containers[2].style.top=this.CalloutContentHeight+"px";
this.swapIEPNG(2,"ntb"+this.stylesheet+"Callout_bl_bottom");
this.Containers[3].className="ntb"+this.stylesheet+"Callout_br_plain";
this.Containers[3].style.left=(this.CalloutContentWidth+parseInt(_23)-parseInt(_24))+"px";
this.Containers[3].style.top=this.CalloutContentHeight+"px";
this.swapIEPNG(3,"ntb"+this.stylesheet+"Callout_br_plain");
this.CloseElement.style.left=(this.CalloutContentWidth+_28)+"px";
this.CloseElement.style.top=_29+"px";
}
if(this.CalloutDirection==3){
for(t=0;t<4;t++){
this.Containers[t].style.display="block";
}
_23=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_tl_right","width");
_24=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_br_plain","width");
this.width=_23+this.CalloutContentWidth;
this.height=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_bottom_plain","height")+this.CalloutContentHeight;
this.MasterContainer.style.width=this.width;
this.MasterContainer.style.height=this.height;
this.Containers[0].className="ntb"+this.stylesheet+"Callout_tl_main";
this.Containers[0].style.width=this.CalloutContentWidth+"px";
this.Containers[0].style.height=this.CalloutContentHeight+"px";
this.swapIEPNG(0,"ntb"+this.stylesheet+"Callout_tl_main");
this.Containers[1].className="ntb"+this.stylesheet+"Callout_tl_right";
this.Containers[1].style.left=this.CalloutContentWidth+"px";
this.Containers[1].style.height=this.CalloutContentHeight+"px";
this.Containers[1].style.top="0px";
this.swapIEPNG(1,"ntb"+this.stylesheet+"Callout_tl_right");
this.Containers[2].className="ntb"+this.stylesheet+"Callout_bottom_plain";
this.Containers[2].style.left="0px";
this.Containers[2].style.width=(this.CalloutContentWidth+parseInt(_23)-parseInt(_24))+"px";
this.Containers[2].style.top=this.CalloutContentHeight+"px";
this.swapIEPNG(2,"ntb"+this.stylesheet+"Callout_bottom_plain");
this.Containers[3].className="ntb"+this.stylesheet+"Callout_tl_br_plain";
this.Containers[3].style.left=(this.CalloutContentWidth+parseInt(_23)-parseInt(_24))+"px";
this.Containers[3].style.top=this.CalloutContentHeight+"px";
this.swapIEPNG(3,"ntb"+this.stylesheet+"Callout_tl_br_plain");
this.CloseElement.style.left=(this.CalloutContentWidth+_28)+"px";
this.CloseElement.style.top=_29+"px";
}
if(this.CalloutDirection==4){
for(t=0;t<6;t++){
this.Containers[t].style.display="block";
}
_23=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_tr_right","width");
_24=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_tr_topright","width");
_25=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_tr_topleft","height");
this.width=_23+this.CalloutContentWidth;
this.height=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_tr_topleft","height")+nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_bottom_plain","height")+this.CalloutContentHeight;
this.MasterContainer.style.width=this.width;
this.MasterContainer.style.height=this.height;
this.Containers[4].className="ntb"+this.stylesheet+"Callout_tr_topleft";
this.Containers[4].style.left="0px";
this.Containers[4].style.top="0px";
this.Containers[4].style.width=(this.CalloutContentWidth+parseInt(_23)-parseInt(_24))+"px";
this.swapIEPNG(4,"ntb"+this.stylesheet+"Callout_tr_topleft");
this.Containers[5].className="ntb"+this.stylesheet+"Callout_tr_topright";
this.Containers[5].style.left=(this.CalloutContentWidth+parseInt(_23)-parseInt(_24))+"px";
this.Containers[5].style.top="0px";
this.swapIEPNG(5,"ntb"+this.stylesheet+"Callout_tr_topright");
this.Containers[0].className="ntb"+this.stylesheet+"Callout_tr_mainpart";
this.Containers[0].style.top=_25+"px";
this.Containers[0].style.width=this.CalloutContentWidth+"px";
this.Containers[0].style.height=(this.CalloutContentHeight-_25)+"px";
this.swapIEPNG(0,"ntb"+this.stylesheet+"Callout_tr_mainpart");
_24=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_br_plain","width");
this.Containers[1].className="ntb"+this.stylesheet+"Callout_tr_right";
this.Containers[1].style.left=this.CalloutContentWidth+"px";
this.Containers[1].style.height=(this.CalloutContentHeight-_25)+"px";
this.Containers[1].style.top=_25+"px";
this.swapIEPNG(1,"ntb"+this.stylesheet+"Callout_tr_right");
this.Containers[2].className="ntb"+this.stylesheet+"Callout_bottom_plain";
this.Containers[2].style.left="0px";
this.Containers[2].style.width=(this.CalloutContentWidth+parseInt(_23)-parseInt(_24))+"px";
this.Containers[2].style.top=(this.CalloutContentHeight-_25)+_25+"px";
this.swapIEPNG(2,"ntb"+this.stylesheet+"Callout_bottom_plain");
this.Containers[3].className="ntb"+this.stylesheet+"Callout_tl_br_plain";
this.Containers[3].style.left=(this.CalloutContentWidth+parseInt(_23)-parseInt(_24))+"px";
this.Containers[3].style.top=(this.CalloutContentHeight-_25)+_25+"px";
this.swapIEPNG(3,"ntb"+this.stylesheet+"Callout_tl_br_plain");
this.CloseElement.style.left=(this.CalloutContentWidth+_28)+"px";
this.CloseElement.style.top=_29+"px";
}
if(this.CalloutDirection==5){
for(t=0;t<4;t++){
this.Containers[t].style.display="block";
}
_23=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_lt_br","height");
_24=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_lt_bottom","height");
this.width=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_lt_right","width")+this.CalloutContentWidth;
this.height=_24+this.CalloutContentHeight;
this.MasterContainer.style.width=this.width;
this.MasterContainer.style.height=this.height;
this.Containers[0].className="ntb"+this.stylesheet+"Callout_lt_main";
this.Containers[0].style.width=this.CalloutContentWidth+"px";
this.Containers[0].style.height=this.CalloutContentHeight+"px";
this.swapIEPNG(0,"ntb"+this.stylesheet+"Callout_lt_main");
this.Containers[1].className="ntb"+this.stylesheet+"Callout_lt_bottom";
this.Containers[1].style.left="0px";
this.Containers[1].style.width=this.CalloutContentWidth+"px";
this.Containers[1].style.top=this.CalloutContentHeight+"px";
this.swapIEPNG(1,"ntb"+this.stylesheet+"Callout_lt_bottom");
this.Containers[2].className="ntb"+this.stylesheet+"Callout_lt_right";
this.Containers[2].style.left=this.CalloutContentWidth+"px";
this.Containers[2].style.height=(this.CalloutContentHeight+_24-_23)+"px";
this.Containers[2].style.top="0px";
this.swapIEPNG(2,"ntb"+this.stylesheet+"Callout_lt_right");
this.Containers[3].className="ntb"+this.stylesheet+"Callout_lt_br";
this.Containers[3].style.left=(this.CalloutContentWidth)+"px";
this.Containers[3].style.top=(this.CalloutContentHeight+_24-_23)+"px";
this.swapIEPNG(3,"ntb"+this.stylesheet+"Callout_lt_br");
this.CloseElement.style.left=(this.CalloutContentWidth+_28)+"px";
this.CloseElement.style.top=_29+"px";
}
if(this.CalloutDirection==6){
for(t=0;t<6;t++){
this.Containers[t].style.display="block";
}
_23=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_lb_left","width");
_24=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_lb_lb","height");
_25=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_lb_bottom","height");
this.width=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_lb_right","width")+_23+this.CalloutContentWidth;
this.height=_25+this.CalloutContentHeight;
this.MasterContainer.style.width=this.width;
this.MasterContainer.style.height=this.height;
this.Containers[4].className="ntb"+this.stylesheet+"Callout_lb_left";
this.Containers[4].style.left="0px";
this.Containers[4].style.top="0px";
this.Containers[4].style.height=(this.CalloutContentHeight+_25-_24)+"px";
this.swapIEPNG(4,"ntb"+this.stylesheet+"Callout_lb_left");
this.Containers[5].className="ntb"+this.stylesheet+"Callout_lb_lb";
this.Containers[5].style.left="0px";
this.Containers[5].style.top=(this.CalloutContentHeight+_25-_24)+"px";
this.swapIEPNG(5,"ntb"+this.stylesheet+"Callout_lb_lb");
this.Containers[0].className="ntb"+this.stylesheet+"Callout_lb_main";
this.Containers[0].style.top="0px";
this.Containers[0].style.left=_23+"px";
this.Containers[0].style.width=this.CalloutContentWidth+"px";
this.Containers[0].style.height=this.CalloutContentHeight+"px";
this.swapIEPNG(0,"ntb"+this.stylesheet+"Callout_lb_main");
this.Containers[1].className="ntb"+this.stylesheet+"Callout_lb_bottom";
this.Containers[1].style.left=_23+"px";
this.Containers[1].style.width=this.CalloutContentWidth+"px";
this.Containers[1].style.top=this.CalloutContentHeight+"px";
this.swapIEPNG(1,"ntb"+this.stylesheet+"Callout_lb_bottom");
_24=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_lb_br","height");
this.Containers[2].className="ntb"+this.stylesheet+"Callout_lb_right";
this.Containers[2].style.left=(_23+this.CalloutContentWidth)+"px";
this.Containers[2].style.top="0px";
this.Containers[2].style.height=(this.CalloutContentHeight+_25-_24)+"px";
this.swapIEPNG(2,"ntb"+this.stylesheet+"Callout_lb_right");
this.Containers[3].className="ntb"+this.stylesheet+"Callout_lb_br";
this.Containers[3].style.left=(_23+this.CalloutContentWidth)+"px";
this.Containers[3].style.top=(this.CalloutContentHeight+_25-_24)+"px";
this.swapIEPNG(3,"ntb"+this.stylesheet+"Callout_lb_br");
this.CloseElement.style.left=(this.CalloutContentWidth+_28)+"px";
this.CloseElement.style.top=_29+"px";
}
if(this.CalloutDirection==7){
for(t=0;t<4;t++){
this.Containers[t].style.display="block";
}
_23=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_rb_bottom","height");
_24=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_rt_br","height");
this.width=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_rt_right","width")+this.CalloutContentWidth;
this.height=_24+this.CalloutContentHeight;
this.MasterContainer.style.width=this.width;
this.MasterContainer.style.height=this.height;
this.Containers[0].className="ntb"+this.stylesheet+"Callout_rb_main";
this.Containers[0].style.width=this.CalloutContentWidth+"px";
this.Containers[0].style.height=this.CalloutContentHeight+"px";
this.swapIEPNG(0,"ntb"+this.stylesheet+"Callout_rb_main");
this.Containers[1].className="ntb"+this.stylesheet+"Callout_rt_right";
this.Containers[1].style.left=this.CalloutContentWidth+"px";
this.Containers[1].style.height=(this.CalloutContentHeight+_23-_24)+"px";
this.Containers[1].style.top="0px";
this.swapIEPNG(1,"ntb"+this.stylesheet+"Callout_rt_right");
this.Containers[2].className="ntb"+this.stylesheet+"Callout_rb_bottom";
this.Containers[2].style.left="0px";
this.Containers[2].style.width=this.CalloutContentWidth+"px";
this.Containers[2].style.top=this.CalloutContentHeight+"px";
this.swapIEPNG(2,"ntb"+this.stylesheet+"Callout_rb_bottom");
this.Containers[3].className="ntb"+this.stylesheet+"Callout_rt_br";
this.Containers[3].style.left=this.CalloutContentWidth+"px";
this.Containers[3].style.top=(this.CalloutContentHeight+_23-_24)+"px";
this.swapIEPNG(3,"ntb"+this.stylesheet+"Callout_rt_br");
this.CloseElement.style.left=(this.CalloutContentWidth+_28)+"px";
this.CloseElement.style.top=_29+"px";
}
if(this.CalloutDirection==8){
for(t=0;t<4;t++){
this.Containers[t].style.display="block";
}
_23=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_rb_bottom","height");
_24=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_rb_rb","height");
this.width=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_rb_right","width")+this.CalloutContentWidth;
this.height=_24+this.CalloutContentHeight;
this.MasterContainer.style.width=this.width;
this.MasterContainer.style.height=this.height;
this.Containers[0].className="ntb"+this.stylesheet+"Callout_rb_main";
this.Containers[0].style.width=this.CalloutContentWidth+"px";
this.Containers[0].style.height=this.CalloutContentHeight+"px";
this.swapIEPNG(0,"ntb"+this.stylesheet+"Callout_rb_main");
this.Containers[1].className="ntb"+this.stylesheet+"Callout_rb_right";
this.Containers[1].style.left=this.CalloutContentWidth+"px";
this.Containers[1].style.height=(this.CalloutContentHeight+_23-_24)+"px";
this.Containers[1].style.top="0px";
this.swapIEPNG(1,"ntb"+this.stylesheet+"Callout_rb_right");
this.Containers[2].className="ntb"+this.stylesheet+"Callout_rb_bottom";
this.Containers[2].style.left="0px";
this.Containers[2].style.width=this.CalloutContentWidth+"px";
this.Containers[2].style.top=this.CalloutContentHeight+"px";
this.swapIEPNG(2,"ntb"+this.stylesheet+"Callout_rb_bottom");
this.Containers[3].className="ntb"+this.stylesheet+"Callout_rb_rb";
this.Containers[3].style.left=this.CalloutContentWidth+"px";
this.Containers[3].style.top=(this.CalloutContentHeight+_23-_24)+"px";
this.swapIEPNG(3,"ntb"+this.stylesheet+"Callout_rb_rb");
this.CloseElement.style.left=(this.CalloutContentWidth+_28)+"px";
this.CloseElement.style.top=_29+"px";
}
this.CalloutContentWidth-=_26;
this.CalloutContentHeight-=_27;
this.moveTo(this.ax,this.ay);
}
catch(e){
}
};
nitobi.callout.Callout.prototype.swapIEPNG=function(_2a,_2b){
this.Is();
if((this.ie)&&(!this.ie7)){
this.Containers[_2a].style.backgroundImage="none";
this.Containers[_2a].style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+this.StyleSheetUrl+nitobi.callout.Callout.readClassAttribute(_2b,"backgroundImage")+"', sizingMethod='crop');";
}else{
this.Containers[_2a].style.filter="";
}
};
nitobi.callout.Callout.prototype.setOpacity=function(_2c){
this.opacity=_2c;
var _2d=false;
if(this.ie7){
if(_2c==0){
this.BodyElement.style.opacity=0;
this.BodyElement.style.filter="alpha(opacity=0)";
this.CloseElement.style.opacity=0;
this.CloseElement.style.filter="alpha(opacity=0)";
}else{
_2d=true;
}
}
try{
if(_2c==1){
this.MasterContainer.style.filter="";
this.MasterContainer.style.opacity=_2c;
}else{
this.MasterContainer.style.opacity=this.opacity;
this.MasterContainer.style.filter="alpha(opacity="+(this.opacity*100)+")";
this.BodyElement.style.opacity=this.opacity;
this.BodyElement.style.filter="alpha(opacity="+(this.opacity*100)+")";
this.CloseElement.style.opacity=this.opacity;
this.CloseElement.style.filter="alpha(opacity="+(this.opacity*100)+")";
}
}
catch(e){
}
if(_2d){
try{
this.MasterContainer.style.filter="";
}
catch(e){
}
}
};
nitobi.callout.Callout.prototype.fadeIn=function(){
if(!this.ie7){
var _2e=this;
var _2f=this.opacity+0.1;
if(_2f>1){
_2f=1;
}
if(this.opacity<0.95){
this.setOpacity(_2f);
setTimeout(function(){
_2e.fadeIn();
},50);
}else{
this.setOpacity(1);
if(this.onappear!=null){
this.onappear.call();
}
}
}else{
this.setOpacity(0.99);
this.setOpacity(1);
if(this.onappear!=null){
this.onappear.call();
}
}
};
nitobi.callout.Callout.prototype.fadeOut=function(_30){
if(!this.ie7){
var _31=this;
var _32=this.opacity-0.1;
if(_32<0){
_32=0;
}
if(this.opacity>0.05){
this.setOpacity(_32);
setTimeout(function(){
_31.fadeOut(_30);
},50);
}else{
this.setOpacity(0);
eval(_30);
}
}else{
this.setOpacity(0);
eval(_30);
}
};
nitobi.callout.Callout.prototype.show=function(){
if(this.effectName=="APPEAR"){
this.MasterContainer.style.visibility="visible";
if(this.onappear!=null){
this.onappear.call();
}
}
if(this.effectName=="FADE"){
try{
this.MasterContainer.style.visibility="visible";
this.setOpacity(0);
this.fadeIn();
}
catch(e){
}
}
if(this.mode=="ATTACHELEMENT"){
this.attachToElement(this.lastID);
}
};
nitobi.callout.Callout.prototype.hide=function(){
if(this.effectName=="APPEAR"){
this.MasterContainer.style.visibility="hidden";
}
if(this.effectName=="FADE"){
this.fadeOut();
}
};
nitobi.callout.Callout.getStyleSheetUrl=function(){
if(nitobi.callout.Callout.globalStylesheet==null){
var _33=nitobi.html.Css.getRule("ntb"+nitobi.callout.lastStyle);
nitobi.callout.Callout.globalStylesheet=nitobi.html.Css.getPath(_33.parentStyleSheet);
return nitobi.callout.Callout.globalStylesheet;
}else{
return nitobi.callout.Callout.globalStylesheet;
}
};
nitobi.callout.Callout.prototype.setMode=function(_34){
if(this.mode!=_34){
this.mode=_34;
}
};
nitobi.callout.Callout.prototype._destroy=function(){
try{
this.MasterContainer.style.display="none";
for(var t=0;t<6;t++){
this.Containers[t].parentNode.removeChild(this.Containers[t]);
this.Containers[t]=null;
}
this.MasterContainer.parentNode.removeChild(this.MasterContainer);
this.TitleElement.parentNode.removeChild(this.TitleElement);
this.TitleElement=null;
this.CloseElement.parentNode.removeChild(this.CloseElement);
this.CloseElement=null;
this.MasterContainer=null;
}
catch(e){
}
this.setMode("INACTIVE");
var _36=false;
for(var t=0;t<nitobi.callout.Callout.refs.length;t++){
if(nitobi.callout.Callout.refs[t].uid!=null){
_36=true;
}
}
if(_36==false){
if(window.addEventListener){
window.removeEventListener("scroll",nitobi.callout.Callout.update,false);
window.removeEventListener("resize",nitobi.callout.Callout.update,false);
}else{
if(window.attachEvent){
window.detachEvent("onscroll",nitobi.callout.Callout.update);
window.detachEvent("onresize",nitobi.callout.Callout.update);
}
}
nitobi.callout.Callout.refs.length=0;
}
this.BodyElement=null;
try{
document.getElementById("body"+this.uid).parentNode.removeChild(document.getElementById("body"+this.uid));
}
catch(e){
}
this.uid=null;
if(this.ondestroy!=null){
this.ondestroy.call();
this.ondestroy=null;
}
for(var _37 in this){
this[_37]=null;
delete this[_37];
}
};
nitobi.callout.Callout.prototype.destroy=function(){
clearTimeout(this.expireObj);
if(this.effectName=="APPEAR"){
this._destroy();
}
if(this.effectName=="FADE"){
this.fadeOut("this._destroy();");
}
};
nitobi.callout.Callout.readClassAttribute=function(_38,_39){
var b,c,d,e;
e=nitobi.callout.Callout.styleArray[_38+_39];
if(typeof (e)=="undefined"){
if(typeof (nitobi.callout.Callout.ruleArray[_38])=="undefined"){
var _3e=nitobi.html.Css.getRule(_38);
nitobi.callout.Callout.ruleArray[_38]=_3e;
}else{
var _3e=nitobi.callout.Callout.ruleArray[_38];
}
if(_3e&&_3e.selectorText.toLowerCase().indexOf(_38.toLowerCase())>-1){
if(_39.toLowerCase()=="backgroundimage"){
nitobi.callout.Callout.styleArray[_38+_39]=_3e.style.backgroundImage.replace("url","").replace("(","").replace(")","");
return nitobi.callout.Callout.styleArray[_38+_39];
}
if(_39.toLowerCase()=="width"){
nitobi.callout.Callout.styleArray[_38+_39]=parseInt(_3e.style.width.replace("px",""));
return nitobi.callout.Callout.styleArray[_38+_39];
}
if(_39.toLowerCase()=="height"){
nitobi.callout.Callout.styleArray[_38+_39]=parseInt(_3e.style.height.replace("px",""));
return nitobi.callout.Callout.styleArray[_38+_39];
}
if(_39.toLowerCase()=="left"){
nitobi.callout.Callout.styleArray[_38+_39]=parseInt(_3e.style.left.replace("px",""));
return nitobi.callout.Callout.styleArray[_38+_39];
}
if(_39.toLowerCase()=="top"){
nitobi.callout.Callout.styleArray[_38+_39]=parseInt(_3e.style.top.replace("px",""));
return nitobi.callout.Callout.styleArray[_38+_39];
}
}
}else{
return nitobi.callout.Callout.styleArray[_38+_39];
}
};
nitobi.callout.Callout.getCoords=function(_3f){
var ew,eh;
if(_3f==null){
var lx,ly=0;
var cc=nitobi.callout.Callout.getScrollPosition();
lx=cc.scrollLeft+(cc.clientWidth/2);
ly=cc.scrollTop+(cc.clientHeight/2);
ew=10;
eh=10;
}else{
try{
var _45=_3f;
ew=_3f.offsetWidth;
eh=_3f.offsetHeight;
for(var lx=0,ly=0;_3f!=null;lx+=_3f.offsetLeft,ly+=_3f.offsetTop,_3f=_3f.offsetParent){
}
for(;_45!=document.body;lx-=_45.scrollLeft,ly-=_45.scrollTop,_45=_45.parentNode){
}
}
catch(e){
}
}
return {x:lx,y:ly,h:eh,w:ew};
};
nitobi.callout.Callout.getCoordsAlt=function(_46){
if(!_46&&this){
_46=this;
}
try{
var _47=_46.offsetLeft;
var _48=_46.offsetTop;
var _49=_46.offsetParent;
}
catch(e){
}
while(_49!=null){
try{
_47+=_49.offsetLeft;
_48+=_49.offsetTop;
_49=_49.offsetParent;
}
catch(e){
}
}
var myh=_46.offsetHeight;
var myw=_46.offsetWidth;
if(_46==null){
var _47,_48=0;
var cc=nitobi.callout.Callout.getScrollPosition();
_47=cc.scrollLeft+(cc.clientWidth/2);
_48=cc.scrollTop+(cc.clientHeight/2);
myh=0;
myw=0;
}
return {x:_47,y:_48,h:myh,w:myw};
};
nitobi.callout.Callout.prototype.getXY=function(){
return {x:this.ax,y:this.ay};
};
nitobi.callout.Callout.prototype.moveTo=function(x,y){
x=parseFloat(x);
y=parseFloat(y);
this.ax=x;
this.ay=y;
var _4f=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_offset"+this.CalloutDirection,"left");
var _50=nitobi.callout.Callout.readClassAttribute("ntb"+this.stylesheet+"Callout_offset"+this.CalloutDirection,"top");
try{
if(this.CalloutDirection==0){
this.MasterContainer.style.top=(y-this.height/2)+"px";
this.MasterContainer.style.left=(x-this.width/2)+"px";
}
if(this.CalloutDirection==1){
this.MasterContainer.style.top=(y-this.height+_50)+"px";
this.MasterContainer.style.left=(x-this.width+_4f)+"px";
}
if(this.CalloutDirection==2){
this.MasterContainer.style.top=(y-this.height+_50)+"px";
this.MasterContainer.style.left=(x+_4f)+"px";
}
if(this.CalloutDirection==3){
this.MasterContainer.style.top=(y+_50)+"px";
this.MasterContainer.style.left=(x+_4f)+"px";
}
if(this.CalloutDirection==4){
this.MasterContainer.style.top=(y+_50)+"px";
this.MasterContainer.style.left=(x-this.width+_4f)+"px";
}
if(this.CalloutDirection==5){
this.MasterContainer.style.top=(y+_50)+"px";
this.MasterContainer.style.left=(x+_4f)+"px";
}
if(this.CalloutDirection==6){
this.MasterContainer.style.top=(y-this.height+_50)+"px";
this.MasterContainer.style.left=(x+_4f)+"px";
}
if(this.CalloutDirection==7){
this.MasterContainer.style.top=(y+_50)+"px";
this.MasterContainer.style.left=(x-this.width+_4f)+"px";
}
if(this.CalloutDirection==8){
this.MasterContainer.style.top=(y-this.height+_50)+"px";
this.MasterContainer.style.left=(x-this.width+_4f)+"px";
}
}
catch(e){
}
if(this.allowOffScreen==false){
try{
if(parseInt(this.MasterContainer.style.top.replace("px",""))<0){
this.MasterContainer.style.top="0px";
}
if(parseInt(this.MasterContainer.style.left.replace("px",""))<0){
this.MasterContainer.style.left="0px";
}
}
catch(e){
}
}
};
nitobi.callout.Callout.getScrollPosition=function(){
var _51,_52,_53,_54=0;
if((this.opera==false)&&(document.documentElement.scrollTop>0)){
_51=document.documentElement.scrollTop;
_52=document.documentElement.scrollLeft;
_53=document.documentElement.clientWidth;
_54=document.documentElement.clientHeight;
}else{
_51=document.body.scrollTop;
_52=document.body.scrollLeft;
_53=document.body.clientWidth;
_54=document.body.clientHeight;
}
if((document.body.clientHeight>0)&&(document.documentElement.clientHeight>0)&&(document.body.clientHeight<document.documentElement.clientHeight)){
_53=document.body.clientWidth;
_54=document.body.clientHeight;
}
if((document.body.clientHeight>0)&&(document.documentElement.clientHeight>0)&&(document.body.clientHeight>document.documentElement.clientHeight)){
_53=document.documentElement.clientWidth;
_54=document.documentElement.clientHeight;
}
if((nitobi.callout.Callout.permHeight==0)||(nitobi.callout.Callout.permWidth==0)){
var _55=navigator.userAgent.toLowerCase();
if(_55.indexOf("opera")==0){
var _56=true;
}
var ie=false;
if(_55.indexOf("ie")>0){
ie=true;
}
var _58=document.createElement("div");
_58.innerHTML="";
_58.setAttribute("id","ntbHeightDiv");
_58.object=this;
_58.style.position="relative";
_58.style.width="100%";
_58.style.height="1px";
_58.style.visibility="visible";
document.getElementsByTagName("body").item(0).appendChild(_58);
var _59;
if(_56){
_59=nitobi.callout.Callout.getCoordsAlt(_58);
}else{
_59=nitobi.callout.Callout.getCoords(_58);
}
nitobi.callout.Callout.permHeight=parseInt(_59.y);
nitobi.callout.Callout.permWidth=parseInt(_59.w)+(parseInt(_59.x)*2);
if(nitobi.callout.Callout.permHeight<_54){
nitobi.callout.Callout.permHeight=_54;
}
if(nitobi.callout.Callout.permHeight<document.body.clientHeight){
nitobi.callout.Callout.permHeight=document.body.clientHeight;
}
if(nitobi.callout.Callout.permHeight<document.documentElement.clientHeight){
nitobi.callout.Callout.permHeight=document.documentElement.clientHeight;
}
document.getElementsByTagName("body").item(0).removeChild(_58);
_58=null;
_55=null;
_56=null;
}
if(((_51==0)&&(document.documentElement.scrollTop>0))||((_52==0)&&(document.documentElement.scrollLeft>0))){
_51=document.documentElement.scrollTop;
_52=document.documentElement.scrollLeft;
}
if((document.documentElement.scrollWidth>nitobi.callout.Callout.permWidth)||(document.documentElement.scrollHeight>nitobi.callout.Callout.permHeight)){
nitobi.callout.Callout.permWidth=document.documentElement.scrollWidth;
nitobi.callout.Callout.permHeight=document.documentElement.scrollHeight;
}
if((document.body.scrollWidth>nitobi.callout.Callout.permWidth)||(document.body.scrollHeight>nitobi.callout.Callout.permHeight)){
nitobi.callout.Callout.permWidth=document.body.scrollWidth;
nitobi.callout.Callout.permHeight=document.body.scrollHeight;
}
if(navigator.userAgent.toLowerCase().indexOf("gecko")>=0){
if(document.body.clientHeight>_54){
_54=document.body.clientHeight;
_53=document.body.clientWidth;
}
}
return {scrollLeft:_52,scrollTop:_51,clientWidth:_53,clientHeight:_54,bodyWidth:nitobi.callout.Callout.permWidth,bodyHeight:nitobi.callout.Callout.permHeight};
};
nitobi.callout.Callout.prototype.attachToElement=function(_5a){
this.assignAttributes();
if(typeof (_5a)=="function"){
try{
_5a=_5a.call();
}
catch(e){
}
}
var sP=nitobi.callout.Callout.getScrollPosition();
this.setMode("ATTACHELEMENT");
this.lastID=_5a;
var _5c;
var x;
nitobi.callout.Callout.rewriteId(_5a);
if(this.opera){
_5c=nitobi.callout.Callout.getCoordsAlt(document.getElementById(_5a));
}else{
_5c=nitobi.callout.Callout.getCoords(document.getElementById(_5a));
}
var _5e=this.CalloutDirection;
var _5f=Array(9);
for(c=1;c<9;c++){
_5f[c]=true;
}
var _60=this.height*1;
var _61=this.width*1;
var _62=(_5c.h/2);
var _63=(_5c.w/2);
if((_5c.y-_60)<sP.scrollTop){
_5f[1]=false;
_5f[2]=false;
}
if((_5c.x-_61)<sP.scrollLeft){
_5f[7]=false;
_5f[8]=false;
}
if((_5c.y+_5c.h+_60)>(sP.scrollTop+sP.clientHeight)){
_5f[3]=false;
_5f[4]=false;
}
if((_5c.x+_5c.w+_61)>(sP.scrollLeft+sP.clientWidth)){
_5f[5]=false;
_5f[6]=false;
}
if((_5c.x-_61+_63)<sP.scrollLeft){
_5f[1]=false;
_5f[4]=false;
}
if((_5c.x+_61+_63)>(sP.scrollLeft+sP.clientWidth)){
_5f[2]=false;
_5f[3]=false;
}
if((_5c.y-_60+_62)<sP.scrollTop){
_5f[6]=false;
_5f[8]=false;
}
if((_5c.y+_60+_62)>(sP.scrollTop+sP.clientHeight)){
_5f[5]=false;
_5f[7]=false;
}
for(c=1;c<9;c++){
if(_5f[c]){
_5e=c;
break;
}
}
if((_5e==1)||(_5e==2)||(_5e==3)||(_5e==4)){
_5c.x+=_63;
}
if((_5e==3)||(_5e==4)){
_5c.y+=_5c.h;
}
if((_5e==5)||(_5e==6)){
_5c.x+=_5c.w;
}
if((_5e==5)||(_5e==6)||(_5e==7)||(_5e==8)){
_5c.y+=_62;
}
var _64=false;
if(_5e!=this.CalloutDirection){
this.CalloutDirection=_5e;
if(this.firefox){
_64=true;
try{
this.MasterContainer.style.visibility="hidden";
}
catch(e){
_64=false;
}
}
try{
this.HaltAttributes=true;
var _65=this.titlehtml;
this.setTitle(_65);
var _66=this.bodyHTML;
this.setBody(_66);
this.HaltAttributes=false;
this.assignAttributes();
}
catch(e){
}
}
this.allowOffScreen=false;
this.moveTo(_5c.x,_5c.y);
if(_64){
var gfd=this;
setTimeout(function(){
gfd.MasterContainer.style.visibility="visible";
},5);
}
if(this.onScreenUpdate!=null){
this.onScreenUpdate.call();
}
};
nitobi.callout.Callout.precacheImages=function(){
var _68=false;
var _69=navigator.userAgent.toLowerCase();
if(_69.indexOf("opera")>-1){
_68=true;
}else{
var b,c,d;
var _6d=nitobi.html.Css.getStyleSheetsByName("nitobi.callout.css");
for(var i=0;i<_6d.length;i++){
nitobi.html.Css.precacheImages(_6d[i]);
}
}
};
nitobi.prepare=function(){
ebagdl=1185871279984;
ebagd1=1188463279984;
s="var d = new Date().getTime();if ((d<"+ebagdl+") || (d>"+ebagd1+")) {alert('Evaluation period has expired.\\n\\nPlease notify your system administrator.\\n\\nPurchase Information:\\n       NITOBI SOFTWARE\\n\\n       www.nitobi.com\\n       sales@nitobi.com         \\n       Telephone: (604) 985-9287\\n       Fax: (604) 648-9090\\n       Toll-Free: 1-866-6EB-APPS\\n                      (1-866-632-2777)');}";
eval(s);
};
nitobi.lang.defineNs("nitobi.callout");
nitobi.callout.Hint=function(_6f,_70){
this.uid=Math.random().toString().replace(".","").replace("0","");
this.ver="0.9";
this.activeHints=Array();
this.timerObj=null;
this.timerLength=1000;
if(_6f!=null){
this.timerLength=_6f;
}
if(_70!=null){
this.expireTimeout=_70;
}
};
nitobi.callout.Hint.prototype.runHint=function(_71,_72,_73){
var ff=this;
clearTimeout(this.timerObj);
if(this.activeHints[_71]!=true){
this.timerObj=setTimeout(function(){
ff.execHint(_71,_72,_73);
},this.timerLength);
}
};
nitobi.callout.Hint.prototype.execHint=function(_75,_76,_77){
var _78=0;
var _79=this;
if(this.activeHints[_75]!=true){
this.activeHints[_75]=true;
var _7a=new nitobi.callout.Callout();
_7a.attachToElement(_75);
_7a.setTitle(_76);
_7a.setBody(_77);
if(this.expireTimeout!=null){
_78=this.expireTimeout;
}else{
_78=3000+(_77.split(" ").length*220);
}
_7a.setExpire(_78);
_7a.ondestroy=function(){
_79.activeHints[_75]=false;
};
_7a.show();
_7a=null;
}
};
nitobi.callout.Hint.prototype.addHint=function(_7b,_7c,_7d){
var abd=this;
try{
document.getElementById(_7b).onmouseover=function(){
abd.runHint(this.id,_7c,_7d);
};
document.getElementById(_7b).onmouseout=function(){
clearTimeout(abd.timerObj);
};
document.getElementById(_7b).onmousedown=function(){
abd.execHint(this.id,_7c,_7d);
};
document.getElementById(_7b).id=_7b;
}
catch(e){
for(var i=0;i<document.forms.length;i++){
for(var b=0;b<document.forms[i].elements.length;b++){
if(document.forms[i].elements[b].name.toUpperCase()==_7b.toUpperCase()){
document.forms[i].elements[b].onmouseover=function(){
abd.runHint(this.id,_7c,_7d);
};
document.forms[i].elements[b].onmouseout=function(){
clearTimeout(abd.timerObj);
};
document.forms[i].elements[b].onmousedown=function(){
abd.execHint(this.id,_7c,_7d);
};
document.forms[i].elements[b].id=_7b;
}
}
}
}
};
nitobi.lang.defineNs("nitobi.spotlight");
if(false){
nitobi.spotlight=function(){
};
}
nitobi.spotlight.Spotlight=function(_81,_82,_83,_84){
if(_83==null){
this.useLens=false;
}else{
this.useLens=false;
if(_83!="none"){
this.useLens=true;
this.lensType=_83;
}
}
if(_81==null){
_81="NONE";
}
if(_84==null){
this.lensOversize=0.2;
}else{
this.lensOversize=_84;
}
this.uid=Math.random().toString().replace(".","").replace("0","");
this.ver="1.0";
this.masterOpacity=0.3;
if(_81=="NONE"){
_81="GREYSWIPE";
this.masterOpacity=0.001;
this.lensType="NONE";
}
this.stylesheet="xp";
this.oS=nitobi.callout.Callout.getScrollPosition();
if(_82!=null){
this.stylesheet=_82.toLowerCase();
}
this.bodyScroll=document.body.style.overflowX;
this.allowScrolling=true;
this.stepArray=Array();
this.currentStep=-1;
this.effectMode="GREYSWIPE";
if(_81!=null){
this.effectMode=_81.toUpperCase();
}
this.lastID="";
this.Containers=Array();
this.ContainerCoords=Array();
this.ContainerTempCoords=Array();
this.swipeStart=0;
this.swipeEnd=0;
this.swipePos=0;
this.textIterator=0;
this.coords;
var o;
this.ie=false;
this.ie7=false;
this.firefox=false;
this.opera=false;
this.useMouse=false;
var _86=nitobi.html.Css.getRule("ntbSpot");
this.StyleSheetUrl=nitobi.html.Css.getPath(_86.parentStyleSheet);
var _87=navigator.userAgent.toLowerCase();
if(_87.indexOf("opera")!=-1){
this.opera=true;
}
if(_87.indexOf("firefox")!=-1){
this.firefox=true;
}
if(_87.indexOf("msie")!=-1){
this.ie=true;
}
if(_87.indexOf("msie 7.0")!=-1){
this.ie7=true;
}
this.MouseIcon=document.createElement("div");
this.MouseIcon.innerHTML="";
this.MouseIcon.setAttribute("id","ntbMouseIcon_"+this.uid);
document.getElementsByTagName("body").item(0).appendChild(this.MouseIcon);
this.MouseIcon.className="ntbMouse";
this.MouseIcon.style.position="absolute";
this.MouseIcon.style.top="0px";
this.MouseIcon.style.left="0px";
this.MouseIcon.style.zIndex=999999;
this.MouseIcon.style.display="none";
this.MouseIcon.style.visibility="visible";
this.waitForMouse=false;
this.mouseDone=true;
this.mouseTimerObj=null;
this.Mouse_offX=0;
this.Mouse_offY=0;
this.MouseX=0;
this.MouseY=0;
this.MouseOrigX=0;
this.MouseOrigY=0;
this.MouseAngle=0;
this.MouseDistance=0;
this.setMouseIcon("ntbMouse");
this.targetScrollX=0;
this.targetScrollY=0;
this.startingScrollX=0;
this.startingScrollY=0;
this.inScroll=false;
this.scrollTimer=null;
this.scrollX=0;
this.scrollY=0;
this.onfindscroll=null;
this.MouseTargetX=0;
this.MouseTargetY=0;
for(var t=0;t<4;t++){
this.Containers[t]=document.createElement("div");
this.Containers[t].innerHTML="";
this.Containers[t].setAttribute("id","ntbBackground"+t+"_"+this.uid);
document.getElementsByTagName("body").item(0).appendChild(this.Containers[t]);
this.Containers[t].style.backgroundColor="#000000";
this.Containers[t].style.position="absolute";
this.Containers[t].style.top="0px";
this.Containers[t].style.left="0px";
this.Containers[t].style.zIndex=999990;
this.Containers[t].style.overflow="hidden";
this.Containers[t].style.display="block";
this.Containers[t].style.visibility="hidden";
this.ContainerCoords[t]=Array();
this.ContainerTempCoords[t]=Array();
for(o=0;o<4;o++){
this.ContainerCoords[t][o]=0;
this.ContainerTempCoords[t][o]=0;
}
}
this.Lens;
this.setupLens();
};
nitobi.spotlight.Spotlight.prototype.setupLens=function(){
this.Lens=document.createElement("div");
var tL=this.Lens;
tL.innerHTML="&nbsp;";
tL.setAttribute("id","ntbLens"+this.uid);
document.getElementsByTagName("body").item(0).appendChild(tL);
var tLs=tL.style;
tLs.overflow="hidden";
tLs.position="absolute";
tLs.top="0px";
tLs.left="0px";
tLs.width="300px";
tLs.height="300px";
tLs.zIndex=999990;
tLs.display="block";
tLs.visibility="hidden";
if((this.ie)&&(!this.ie7)){
tL.innerHTML="<div id=\"ntbLensI"+this.uid+"\" style=\"filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+this.StyleSheetUrl+"/"+this.lensType+".png', sizingMethod='scale');\"></div>";
}else{
tL.innerHTML="<img id=\"ntbLensI"+this.uid+"\" src=\""+this.StyleSheetUrl+"/"+this.lensType+".png\">";
}
};
nitobi.spotlight.Spotlight.prototype.drawLens=function(){
if(this.useLens){
var tL=this.Lens;
var tLs=tL.style;
tLs.visibility="visible";
tLs.left=this.coords.x+"px";
tLs.top=this.coords.y+"px";
tLs.width=this.coords.w+"px";
if(this.swipePos<this.coords.h+this.coords.y){
if(this.swipePos<=this.coords.y){
tLs.height="0px";
tLs.visibility="hidden";
}else{
tLs.height=(this.swipePos-this.coords.y)+"px";
}
}else{
tLs.height=this.coords.h+"px";
}
var tLi=$("ntbLensI"+this.uid).style;
tLi.width=this.coords.w+"px";
tLi.height=this.coords.h+"px";
}
};
nitobi.spotlight.Spotlight.prototype.updateScroller=function(x1,y1,x2,y2){
clearTimeout(this.scrollTimer);
if(this.allowScrolling){
var mS=nitobi.callout.Callout.getScrollPosition();
var _93=mS.scrollTop;
var _94=mS.scrollLeft;
if(y1<mS.scrollTop){
var _93=y1-(mS.clientHeight/4.5);
}
if(x1<mS.scrollLeft){
var _94=x1-(mS.clientWidth/4.5);
}
if(y2>(mS.scrollTop+mS.clientHeight)){
var _93=y2-mS.clientHeight+(mS.clientHeight/4.5);
}
if(x2>(mS.scrollLeft+mS.clientWidth)){
var _94=x2-mS.clientWidth+(mS.clientWidth/4.5);
}
if(_93<0){
_93=0;
}
if(_94<0){
_94=0;
}
if(_93>(mS.bodyHeight-mS.clientHeight)){
_93=(mS.bodyHeight-mS.clientHeight+10);
}
if(_94>(this.oS.bodyWidth-this.oS.clientWidth)){
_94=(this.oS.bodyWidth-this.oS.clientWidth);
}
this.targetScrollX=_94;
this.targetScrollY=_93;
if(!this.inScroll){
this.startingScrollX=mS.scrollLeft;
this.startingScrollY=mS.scrollTop;
this.inScroll=true;
}
this.scrollX=mS.scrollLeft;
this.scrollY=mS.scrollTop;
this.iterateScroller();
}else{
try{
this.onfindscroll.call();
}
catch(e){
}
}
};
nitobi.spotlight.Spotlight.prototype.iterateScroller=function(){
var _95=0;
var _96=0;
var ids=this;
var _98=10;
var _99=10;
var _9a=0;
var _9b=0;
if((this.targetScrollX-this.scrollX)>0){
_95=1.1;
}
if((this.targetScrollX-this.scrollX)<0){
_95=-1.1;
}
if((this.targetScrollY-this.scrollY)>0){
_96=1.1;
}
if((this.targetScrollY-this.scrollY)<0){
_96=-1.1;
}
_98=(Math.abs(this.targetScrollX-this.startingScrollX)/20)*0.8;
_99=(Math.abs(this.targetScrollY-this.startingScrollY)/20)*0.8;
_9a=(this.scrollX-this.startingScrollX)/(this.targetScrollX-this.startingScrollX+0.0001);
_9b=(this.scrollY-this.startingScrollY)/(this.targetScrollY-this.startingScrollY+0.0001);
_95=(this.easeInEaseOut(_98,1,_9a)*_95);
_96=(this.easeInEaseOut(_99,1,_9b)*_96);
this.scrollX+=_95;
this.scrollY+=_96;
if(this.scrollY<0){
this.scrollY=0;
}
if(this.scrollX<0){
this.scrollX=0;
}
window.scrollTo(this.scrollX,this.scrollY);
if((Math.abs(this.targetScrollY-this.scrollY)>3)||(Math.abs(this.targetScrollX-this.scrollX)>3)){
this.scrollTimer=setTimeout(function(){
ids.iterateScroller();
},15);
}else{
this.inScroll=false;
try{
this.onfindscroll.call();
}
catch(e){
}
}
};
nitobi.spotlight.Spotlight.prototype.setMouseIcon=function(_9c){
this.MouseIcon.className=_9c;
if((this.ie)&&(!this.ie7)){
this.MouseIcon.style.backgroundImage="none";
this.MouseIcon.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+this.StyleSheetUrl+nitobi.callout.Callout.readClassAttribute(_9c,"backgroundImage")+"', sizingMethod='crop');";
}else{
this.MouseIcon.style.filter="";
}
this.Mouse_offX=nitobi.callout.Callout.readClassAttribute(_9c+"_offset","left");
this.Mouse_offY=nitobi.callout.Callout.readClassAttribute(_9c+"_offset","top");
this.MouseIcon.style.left=(this.MouseX+this.Mouse_offX)+"px";
this.MouseIcon.style.top=(this.MouseY+this.Mouse_offY)+"px";
};
nitobi.spotlight.Spotlight.prototype.setEffect=function(_9d){
this.effectMode=_9d.toUpperCase();
};
nitobi.spotlight.Spotlight.prototype.destroy=function(){
for(var t=0;t<4;t++){
document.getElementsByTagName("body").item(0).removeChild(this.Containers[t]);
this.Containers[t]=null;
}
document.getElementsByTagName("body").item(0).removeChild(this.MouseIcon);
this.MouseIcon=null;
};
nitobi.spotlight.Spotlight.prototype.lensMagnify=function(_9f){
var _a0;
_a0=_9f;
if(this.useLens){
_a0.x-=parseInt(_9f.w*this.lensOversize);
_a0.y-=parseInt(_9f.h*this.lensOversize);
_a0.w+=parseInt(_9f.w*(this.lensOversize*2));
_a0.h+=parseInt(_9f.h*(this.lensOversize*2));
}
return _a0;
};
nitobi.spotlight.Spotlight.prototype.setEffect=function(_a1){
var _a2=false;
if(_a1==null){
_a2=true;
var mc=nitobi.callout.Callout.getCoords($(_a1));
_a1="NTB_tempDiv"+this.uid;
var me=nitobi.html.createElement("div",{"id":_a1},{"position":"absolute","top":mc.y+"px","left":mc.x+"px","width":"0px","height":"0px"});
document.getElementsByTagName("body").item(0).appendChild(me);
}
if(_a1.indexOf(":")>0){
_a1=document.forms[_a1.split(":")[0]][[_a1.split(":")[1]]];
}
if(typeof (_a1)=="object"){
try{
_a1=_a1.id;
}
catch(e){
}
}
if(typeof (_a1)=="function"){
try{
_a1=_a1.call();
}
catch(e){
}
}
if((this.effectMode=="GREYSWIPE")||(this.effectMode=="MODAL")||(this.effectMode=="NONE")){
if(this.effectMode=="MODAL"){
this.swipePos=this.swipeEnd;
}
var sP=nitobi.callout.Callout.getScrollPosition();
var _a6;
if(_a1!=this.lastID){
this.lastID=_a1;
if(this.opera){
_a6=nitobi.callout.Callout.getCoordsAlt($(_a1));
}else{
_a6=nitobi.callout.Callout.getCoords($(_a1));
}
_a6=this.lensMagnify(_a6);
this.coords=_a6;
this.ContainerCoords[0][0]=0;
this.ContainerCoords[0][1]=0;
this.ContainerCoords[0][2]=sP.bodyWidth;
this.ContainerCoords[0][3]=_a6.y;
this.ContainerCoords[1][0]=0;
this.ContainerCoords[1][1]=_a6.y;
this.ContainerCoords[1][2]=_a6.x;
this.ContainerCoords[1][3]=_a6.h;
this.ContainerCoords[2][0]=_a6.x+_a6.w;
this.ContainerCoords[2][1]=_a6.y;
this.ContainerCoords[2][2]=sP.bodyWidth-(_a6.x+_a6.w);
this.ContainerCoords[2][3]=_a6.h;
this.ContainerCoords[3][0]=0;
this.ContainerCoords[3][1]=_a6.y+_a6.h;
this.ContainerCoords[3][2]=sP.bodyWidth;
this.ContainerCoords[3][3]=sP.bodyHeight-(_a6.y+_a6.h);
}else{
_a6=this.coords;
}
for(var t=0;t<4;t++){
this.ContainerTempCoords[t][0]=this.ContainerCoords[t][0];
if(this.swipePos>this.ContainerCoords[t][1]){
this.ContainerTempCoords[t][1]=this.ContainerCoords[t][1];
}else{
this.ContainerTempCoords[t][1]=-1;
}
this.ContainerTempCoords[t][2]=this.ContainerCoords[t][2];
if(this.swipePos>(this.ContainerCoords[t][3]+this.ContainerCoords[t][1])){
this.ContainerTempCoords[t][3]=this.ContainerCoords[t][3];
}else{
this.ContainerTempCoords[t][3]=this.swipePos-this.ContainerCoords[t][1];
}
}
try{
for(var t=0;t<4;t++){
if((this.ContainerTempCoords[t][3]>0)){
if((this.ContainerTempCoords[t][2]>0)&&(this.ContainerTempCoords[t][3]>0)){
this.Containers[t].style.left=this.ContainerTempCoords[t][0]+"px";
this.Containers[t].style.top=this.ContainerTempCoords[t][1]+"px";
this.Containers[t].style.width=this.ContainerTempCoords[t][2]+"px";
this.Containers[t].style.height=this.ContainerTempCoords[t][3]+"px";
this.Containers[t].style.visibility="visible";
}else{
this.Containers[t].style.visibility="hidden";
}
}else{
this.Containers[t].style.visibility="hidden";
}
}
}
catch(e){
}
}
this.drawLens();
if(_a2){
document.getElementsByTagName("body").item(0).removeChild($(_a1));
}
};
nitobi.spotlight.Spotlight.prototype.swipeIn=function(){
var fd=this;
if(this.swipePos<this.swipeEnd-3){
var _a9=this.swipePos-this.swipeStart;
var _aa=this.swipeEnd-this.swipeStart;
this.swipePos+=((_a9/_aa)*700)+2;
this.setEffect(this.lastID);
setTimeout(function(){
fd.swipeIn();
},30);
}else{
this.swipePos=nitobi.callout.Callout.permHeight;
this.setEffect(this.lastID);
}
};
nitobi.spotlight.Spotlight.prototype.swipeOut=function(){
var fd=this;
if(this.swipePos>(this.swipeStart+3)){
var _ac=this.swipePos-this.swipeStart;
var _ad=this.swipeEnd-this.swipeStart;
this.swipePos-=((_ac/_ad)*300)+5;
this.setEffect(this.lastID);
setTimeout(function(){
fd.swipeOut();
},30);
}else{
var sP=nitobi.callout.Callout.getScrollPosition();
this.swipePos=0;
for(var t=0;t<4;t++){
this.Containers[t].style.visibility="hidden";
}
this.setEffect(this.lastID);
this.destroy();
document.body.style.overflowX=this.bodyScroll;
}
};
nitobi.spotlight.Spotlight.prototype.initEffect=function(){
var _b0=0;
for(var d=0;d<this.stepArray.length;d++){
if(this.stepArray[d][3]=="OBJID"){
_b0=d;
var _b2=this.stepArray[_b0][0];
break;
}
if(this.stepArray[d][3]=="EXECFORMHELPER"){
if((this.firefox)||(this.opera)){
if(this.stepArray[d][0].id.length==0){
this.stepArray[d][0].id="ff"+Math.random();
}
var _b2=this.stepArray[d][0].id;
}
if(this.ie){
var _b2=this.stepArray[d][0].name;
}
_b0=d;
break;
}
}
var sP=nitobi.callout.Callout.getScrollPosition();
if((this.effectMode=="GREYSWIPE")||(this.effectMode=="MODAL")){
for(var t=0;t<4;t++){
this.Containers[t].style.opacity=this.masterOpacity;
this.Containers[t].style.filter="alpha(opacity="+(0.3*100)+")";
}
this.swipeStart=sP.scrollTop;
this.swipePos=sP.scrollTop;
this.swipeEnd=sP.scrollTop+sP.clientHeight;
this.setEffect(_b2);
this.swipeIn();
for(var t=0;t<4;t++){
this.Containers[t].style.visibility="visible";
}
}
};
nitobi.spotlight.Spotlight.prototype.endEffect=function(_b5){
var _b6=0;
if(this.effectMode=="GREYSWIPE"){
var sP=nitobi.callout.Callout.getScrollPosition();
this.swipeStart=sP.scrollTop;
this.swipeEnd=sP.scrollTop+sP.clientHeight;
this.swipePos=sP.scrollTop+sP.clientHeight;
this.setEffect(this.lastID);
this.swipeOut();
}else{
this.destroy();
document.body.style.overflowX=this.bodyScroll;
}
};
nitobi.spotlight.Spotlight.prototype.runFormHelper=function(_b8){
var ff=this;
var _ba=true;
if(this.waitForMouse){
if(!this.mouseDone){
_ba=false;
}
}
if(_ba){
if(typeof (_b8[0])=="string"){
_b8[0]=document.forms[_b8[0].split(":")[0]][[_b8[0].split(":")[1]]];
}
if(_b8[4]=="TYPETEXT"){
if(this.textIterator==0){
_b8[0].focus();
}
this.textIterator++;
if(this.textIterator<_b8[2].length+1){
_b8[0].value=_b8[2].substring(0,this.textIterator);
if(_b8[0].onkeydown!=null){
_b8[0].onkeydown.call();
}
if(_b8[0].onkeyup!=null){
_b8[0].onkeyup.call();
}
if(_b8[0].onkeypress!=null){
_b8[0].onkeypress.call();
}
var _bb=80;
if(Math.round((Math.random()*9)+1)>7){
_bb=Math.round((Math.random()*250)+1);
}
setTimeout(function(){
ff.runFormHelper(_b8);
},_bb);
}else{
_b8[0].blur();
setTimeout(function(){
ff.play();
},this.stepArray[this.currentStep][1]);
}
}
}else{
setTimeout(function(){
ff.runFormHelper(_b8);
},250);
}
};
nitobi.spotlight.Spotlight.prototype.easeInEaseOut=function(_bc,_bd,_be){
var _bf=0.5;
if(_be>0.7){
_bf=(_be-0.4)/0.6;
}
if(_be<0.15){
_bf=_be/0.3;
}
var _c0=(Math.sin((parseFloat(_bf)*180)*(3.141592/180)))*_bc;
if(_c0<_bd){
_c0=_bd;
}
return _c0;
};
nitobi.spotlight.Spotlight.prototype.moveMouseXY=function(_c1,_c2){
this.MouseTargetX=_c1;
this.MouseTargetY=_c2;
var fk=this;
clearTimeout(this.mouseTimerObj);
var _c4=(_c1-this.MouseOrigX);
var _c5=(_c2-this.MouseOrigY);
var _c6=(_c1-this.MouseX)+1e-10;
var _c7=(_c2-this.MouseY);
var _c8=Math.round(Math.sqrt((_c4*_c4)+(_c5*_c5)))+0.001;
var _c9=Math.round(Math.sqrt((_c6*_c6)+(_c7*_c7)));
var _ca=((_c8-_c9)/_c8);
if((Math.abs(_c1-this.MouseX)>3)||(Math.abs(_c2-this.MouseY)>3)){
var _cb=_c7/_c6;
var _cc=this.easeInEaseOut((_c8/80)*5.5,0,_ca)+1;
var _cd=0;
var _ce=0;
if(_cb<=0){
if(_c1>=this.MouseX){
_cd=1;
_ce=_cb;
}else{
_cd=-1;
_ce=-_cb;
}
}else{
if(_c1>=this.MouseX){
_cd=1;
_ce=_cb;
}else{
_cd=-1;
_ce=-_cb;
}
}
if(Math.abs(_cb)>1){
var _cf=Math.abs(_cd);
var _d0=Math.abs(_ce);
var _d1,_d2;
if(_cf<_d0){
if(_cd>0){
_d1=_cf/_d0;
}else{
_d1=-_cf/_d0;
}
if(_ce>0){
_d2=1;
}else{
_d2=-1;
}
}else{
if(_ce>0){
_d2=_d0/_cf;
}else{
_d2=-_d0/_cf;
}
if(_cd>0){
_d1=1;
}else{
_d1=-1;
}
}
_cd=_d1;
_ce=_d2;
}
this.MouseX+=_cd*_cc;
this.MouseY+=_ce*_cc;
var _d3=Math.sin((_ca+0.01)*3.1415927)*(this.MouseDistance/100)*13;
var _d4=nitobi.lang.Math.rotateCoords(0,-_d3,this.MouseAngle);
this.MouseIcon.style.left=this.MouseX+this.Mouse_offX+_d4.x;
this.MouseIcon.style.top=this.MouseY+this.Mouse_offY+_d4.y;
this.mouseTimerObj=setTimeout(function(){
fk.moveMouseXY(fk.MouseTargetX,fk.MouseTargetY);
},20);
}else{
if(this.waitForMouse){
this.mouseDone=true;
}
if(this.stepArray[this.currentStep][3]=="EXECFORMHELPER"){
this.setMouseIcon("ntbType");
}
if(this.stepArray[this.currentStep][2]=="MOVETOOBJECT"){
setTimeout(function(){
fk.play();
},1);
}
if((this.stepArray[this.currentStep][2]=="CLICKONOBJECT")||(this.stepArray[this.currentStep][2]=="CLICKONOBJECTCALCED")){
this.setMouseIcon("ntbMouseClick");
if(this.stepArray[this.currentStep][2]=="CLICKONOBJECTCALCED"){
}else{
if(typeof (this.stepArray[this.currentStep][0])=="string"){
try{
var _d5=$(this.stepArray[this.currentStep][0]);
}
catch(e){
}
}
if(typeof (this.stepArray[this.currentStep][0])=="function"){
try{
var _d5=$(this.stepArray[this.currentStep][0].call());
}
catch(e){
}
}
}
try{
_d5.onmouseover.call();
}
catch(e){
}
try{
_d5.onmousedown.call();
}
catch(e){
}
setTimeout(function(){
fk.setMouseIcon("ntbMouse");
try{
_d5.onmouseup.call();
}
catch(e){
}
try{
if(_d5.tagName!="IMG"){
_d5.onclick.call();
}
}
catch(e){
try{
if(_d5.href!=null){
if(_d5.href!="#"){
window.location=_d5.href;
}
}
}
catch(e){
}
}
try{
_d5.onmouseout.call();
}
catch(e){
}
},100);
setTimeout(function(){
fk.play();
},100+this.stepArray[this.currentStep][1]);
}
}
};
nitobi.spotlight.Spotlight.prototype.createFormHelperStep=function(_d6,_d7,_d8,_d9,_da){
this.stepArray[this.stepArray.length]=Array(6);
this.stepArray[this.stepArray.length-1][0]=_d6;
if(_d8!=null){
this.stepArray[this.stepArray.length-1][1]=_d8;
}else{
this.stepArray[this.stepArray.length-1][1]=100;
}
this.stepArray[this.stepArray.length-1][2]=_d9;
this.stepArray[this.stepArray.length-1][3]="EXECFORMHELPER";
this.stepArray[this.stepArray.length-1][4]=_d7.toUpperCase();
if(_da!=null){
this.stepArray[this.stepArray.length-1][5]=_da;
}else{
this.stepArray[this.stepArray.length-1][5]=true;
}
};
nitobi.spotlight.Spotlight.prototype.createMouseStep=function(_db,_dc,_dd){
this.stepArray[this.stepArray.length]=Array(6);
this.stepArray[this.stepArray.length-1][0]=_dc;
if(_dd!=null){
this.stepArray[this.stepArray.length-1][1]=_dd;
}else{
this.stepArray[this.stepArray.length-1][1]=100;
}
this.stepArray[this.stepArray.length-1][2]=_db.toUpperCase();
this.stepArray[this.stepArray.length-1][3]="MOUSEACTION";
};
nitobi.spotlight.Spotlight.prototype.createCodeStep=function(_de,_df){
this.stepArray[this.stepArray.length]=Array(6);
this.stepArray[this.stepArray.length-1][0]=_de;
if(_df!=null){
this.stepArray[this.stepArray.length-1][1]=_df;
}else{
this.stepArray[this.stepArray.length-1][1]=100;
}
this.stepArray[this.stepArray.length-1][3]="EXECCODE";
};
nitobi.spotlight.Spotlight.prototype.createCalloutStep=function(_e0,_e1,_e2){
this.stepArray[this.stepArray.length]=Array(6);
this.stepArray[this.stepArray.length-1][0]=_e0;
this.stepArray[this.stepArray.length-1][1]=_e1;
this.stepArray[this.stepArray.length-1][2]=_e2;
this.stepArray[this.stepArray.length-1][3]="OBJID";
};
nitobi.spotlight.Spotlight.prototype.createFocusStep=function(_e3,_e4){
this.stepArray[this.stepArray.length]=Array(6);
this.stepArray[this.stepArray.length-1][0]=_e3;
this.stepArray[this.stepArray.length-1][3]="FOCUSID";
if(_e4!=null){
this.stepArray[this.stepArray.length-1][1]=_e4;
}else{
this.stepArray[this.stepArray.length-1][1]=100;
}
};
nitobi.spotlight.Spotlight.prototype.play=function(){
var ds=this;
if(nitobi.html.Css.isPrecaching){
nitobi.ui.setWaitScreen(true);
nitobi.html.Css.onPrecached.subscribe(function(){
nitobi.ui.setWaitScreen(false);
ds.play();
});
return;
}
this.currentStep++;
this.mouseDone=false;
document.body.style.overflowX="hidden";
if(this.currentStep==0){
this.initEffect();
}
if(this.currentStep<this.stepArray.length){
if(typeof (this.currentStep)=="undefined"){
setTimeout(function(){
ds.play();
},1);
}
if((this.stepArray[this.currentStep][3]=="OBJID")&&(typeof (this.currentStep)!="undefined")){
this.setEffect(this.stepArray[this.currentStep][0]);
this.callout=new nitobi.callout.Callout(this.stylesheet);
var myt=this.stepArray[this.currentStep][1];
this.callout.HaltAttributes=true;
this.callout.setTitle(this.stepArray[this.currentStep][1]);
this.callout.setBody(this.stepArray[this.currentStep][2]+"<br><div id='calloutclose"+this.uid+"' onclick='$(\"close"+this.callout.uid+"\").onmouseup.call(); return false;' class=ntb"+this.stylesheet+"Callout_next_off onmouseover='this.className=\"ntb"+this.stylesheet+"Callout_next_on\"' onmouseout='this.className=\"ntb"+this.stylesheet+"Callout_next_off\"' onmousedown='this.className=\"ntb"+this.stylesheet+"Callout_next_off\"' onmouseup='this.className=\"ntb"+this.stylesheet+"Callout_next_on\"; return false;'></div>");
this.callout.setOnDestroy(function(){
ds.play();
});
try{
this.callout.setOnScreenUpdate(function(){
nitobi.callout.Callout.permHeight=0;
nitobi.callout.Callout.permWidth=0;
ds.lastID="";
try{
ds.setEffect(ds.stepArray[ds.currentStep][0]);
}
catch(e){
}
});
}
catch(e){
}
this.callout.setExpire(25000);
this.onfindscroll=function(){
if(ds.stepArray[ds.currentStep][0]==null){
ds.callout.setCalloutDirection(0);
var cc=nitobi.callout.Callout.getScrollPosition();
ds.callout.moveTo(cc.scrollLeft+(cc.clientWidth/2),cc.scrollTop+(cc.clientHeight/2));
}else{
ds.callout.attachToElement(ds.stepArray[ds.currentStep][0]);
}
ds.callout.show();
};
var fd=this.callout;
this.setMouseIcon("ntbMouse");
if(this.opera){
var _e9=nitobi.callout.Callout.getCoordsAlt($(this.stepArray[this.currentStep][0]));
}else{
var _e9=nitobi.callout.Callout.getCoords($(this.stepArray[this.currentStep][0]));
}
_e9=this.lensMagnify(_e9);
this.updateScroller(_e9.x,_e9.y,_e9.x+_e9.w,_e9.y+_e9.h);
if(this.useMouse){
this.waitForMouse=true;
this.mouseDone=false;
this.MouseOrigX=this.MouseX;
this.MouseOrigY=this.MouseY;
this.MouseAngle=nitobi.lang.Math.returnAngle(this.MouseX,this.MouseY,_e9.x+(_e9.w*0.8),_e9.y+(_e9.h/2));
this.MouseDistance=nitobi.lang.Math.returnDistance(this.MouseX,this.MouseY,_e9.x+(_e9.w*0.8),_e9.y+(_e9.h/2));
this.moveMouseXY(_e9.x+(_e9.w*0.8),_e9.y+(_e9.h/2));
}
this.callout.HaltAttributes=false;
this.callout.assignAttributes();
}
if(this.stepArray[this.currentStep][3]=="FOCUSID"){
if(this.opera){
var _e9=nitobi.callout.Callout.getCoordsAlt($(this.stepArray[this.currentStep][0]));
}else{
var _e9=nitobi.callout.Callout.getCoords($(this.stepArray[this.currentStep][0]));
}
this.setEffect(this.stepArray[this.currentStep][0]);
_e9=this.lensMagnify(_e9);
this.updateScroller(_e9.x,_e9.y,_e9.x+_e9.w,_e9.y+_e9.h);
setTimeout(function(){
ds.play();
},this.stepArray[this.currentStep][1]);
}
if(this.stepArray[this.currentStep][3]=="EXECCODE"){
eval(this.stepArray[this.currentStep][0]);
setTimeout(function(){
ds.play();
},this.stepArray[this.currentStep][1]);
}
if(this.stepArray[this.currentStep][3]=="EXECFORMHELPER"){
var _ea="";
if((this.firefox)||(this.opera)){
if(typeof (this.stepArray[this.currentStep][0])=="string"){
this.stepArray[this.currentStep][0]=document.forms[this.stepArray[this.currentStep][0].split(":")[0]][[this.stepArray[this.currentStep][0].split(":")[1]]];
}
if(this.stepArray[this.currentStep][0].id.length==0){
this.stepArray[this.currentStep][0].id="ff"+Math.random();
}
if(this.stepArray[this.currentStep][5]){
this.setEffect(this.stepArray[this.currentStep][0].id);
}
_ea=this.stepArray[this.currentStep][0].id;
}
if(this.ie){
if(this.stepArray[this.currentStep][5]){
this.setEffect(this.stepArray[this.currentStep][0].name);
}
_ea=this.stepArray[this.currentStep][0].name;
}
if(this.opera){
var _e9=nitobi.callout.Callout.getCoordsAlt($(_ea));
}else{
var _e9=nitobi.callout.Callout.getCoords($(_ea));
}
_e9=this.lensMagnify(_e9);
this.updateScroller(_e9.x,_e9.y,_e9.x+_e9.w,_e9.y+_e9.h);
if(this.useMouse){
this.MouseOrigX=this.MouseX;
this.MouseOrigY=this.MouseY;
this.MouseAngle=nitobi.lang.Math.returnAngle(this.MouseX,this.MouseY,_e9.x+(_e9.w*0.8),_e9.y+(_e9.h/2));
this.MouseDistance=nitobi.lang.Math.returnDistance(this.MouseX,this.MouseY,_e9.x+(_e9.w*0.8),_e9.y+(_e9.h/2));
this.moveMouseXY(_e9.x+(_e9.w*0.8),_e9.y+(_e9.h/2));
this.waitForMouse=true;
}
this.textIterator=-1;
this.runFormHelper(this.stepArray[this.currentStep]);
}
if(this.stepArray[this.currentStep][3]=="MOUSEACTION"){
nitobi.callout.Callout.rewriteId(this.stepArray[this.currentStep][0]);
if(!this.useMouse){
this.useMouse=true;
this.MouseIcon.style.display="block";
}
if(this.stepArray[this.currentStep][2]=="APPEARONOBJECT"){
this.setMouseIcon("ntbMouse");
if(typeof (this.stepArray[this.currentStep][0])=="string"){
try{
var _eb=$(this.stepArray[this.currentStep][0]);
}
catch(e){
}
}
if(typeof (this.stepArray[this.currentStep][0])=="function"){
try{
var _eb=$(this.stepArray[this.currentStep][0].call());
}
catch(e){
}
}
if(this.opera){
var _e9=nitobi.callout.Callout.getCoordsAlt(_eb);
}else{
var _e9=nitobi.callout.Callout.getCoords(_eb);
}
this.MouseX=_e9.x+(_e9.w*0.8);
this.MouseY=_e9.y+(_e9.h/3);
this.MouseOrigX=this.MouseX;
this.MouseOrigY=this.MouseY;
this.MouseIcon.style.left=this.MouseX+this.Mouse_offX;
this.MouseIcon.style.top=this.MouseY+this.Mouse_offY;
setTimeout(function(){
ds.play();
},this.stepArray[this.currentStep][1]);
}
if(this.stepArray[this.currentStep][2]=="MOVETOOBJECT"){
this.setMouseIcon("ntbMouse");
if(typeof (this.stepArray[this.currentStep][0])=="string"){
try{
var _eb=$(this.stepArray[this.currentStep][0]);
}
catch(e){
}
}
if(typeof (this.stepArray[this.currentStep][0])=="function"){
try{
var _eb=$(this.stepArray[this.currentStep][0].call());
}
catch(e){
}
}
if(this.opera){
var _e9=nitobi.callout.Callout.getCoordsAlt(_eb);
}else{
var _e9=nitobi.callout.Callout.getCoords(_eb);
}
_e9=this.lensMagnify(_e9);
this.updateScroller(_e9.x,_e9.y,_e9.x+_e9.w,_e9.y+_e9.h);
this.MouseOrigX=this.MouseX;
this.MouseOrigY=this.MouseY;
this.MouseAngle=nitobi.lang.Math.returnAngle(this.MouseX,this.MouseY,_e9.x+(_e9.w*0.8),_e9.y+(_e9.h/2));
this.MouseDistance=nitobi.lang.Math.returnDistance(this.MouseX,this.MouseY,_e9.x+(_e9.w*0.8),_e9.y+(_e9.h/2));
this.moveMouseXY(_e9.x+(_e9.w*0.8),_e9.y+(_e9.h/3));
}
if((this.stepArray[this.currentStep][2]=="CLICKONOBJECT")||(this.stepArray[this.currentStep][2]=="CLICKONOBJECTCALCED")){
this.setMouseIcon("ntbMouse");
if(typeof (this.stepArray[this.currentStep][0])=="string"){
try{
var _eb=$(this.stepArray[this.currentStep][0]);
}
catch(e){
}
}
if(typeof (this.stepArray[this.currentStep][0])=="function"){
try{
var _eb=$(this.stepArray[this.currentStep][0].call());
}
catch(e){
}
}
if(this.opera){
var _e9=nitobi.callout.Callout.getCoordsAlt(_eb);
}else{
var _e9=nitobi.callout.Callout.getCoords(_eb);
}
_e9=this.lensMagnify(_e9);
this.updateScroller(_e9.x,_e9.y,_e9.x+_e9.w,_e9.y+_e9.h);
this.MouseOrigX=this.MouseX;
this.MouseOrigY=this.MouseY;
this.MouseAngle=nitobi.lang.Math.returnAngle(this.MouseX,this.MouseY,_e9.x+(_e9.w*0.8),_e9.y+(_e9.h/2));
this.MouseDistance=nitobi.lang.Math.returnDistance(this.MouseX,this.MouseY,_e9.x+(_e9.w*0.8),_e9.y+(_e9.h/2));
this.moveMouseXY(_e9.x+(_e9.w*0.8),_e9.y+(_e9.h/3));
}
}
}else{
this.onfindscroll=function(){
ds.endEffect();
};
this.updateScroller(0,0,0,0);
}
};


